<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--360浏览器优先以webkit内核解析-->
    <title></title>
    <link href="../../../css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="../../../css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="../../../css/animate.css" rel="stylesheet">
    <link href="../../../css/style.css?v=4.1.0" rel="stylesheet">
    <link href="../../../plugin/datepicker/jquery.datetimepicker.css" rel="stylesheet">
    <link href="../../../plugin/font/iconfont.css" rel="stylesheet">
    <link href="../../../css/common.css" rel="stylesheet">

    <style>
        #topKzCon{padding:10px 20px;;}
        #topKzCon .btn{color:#0055aa;}
        #topKzCon .btn:hover{    background-image: none;  outline: 0;  -webkit-box-shadow: inset 0 3px 5px rgba(0,0,0,.125); }
        .btnRight{float:right;}
        .conBox{width:100%;height:550px;border:1px solid #bbb;}
        #mainCont{width:60%;height:100%;float:left;border-right:1px solid #bbb;}
        #detailCon{width:40%;height:100%;float:left;}
        #mainCont .mainContitleBox{width:100%;height:74px;line-height: 45px;padding:0 6px;border-bottom:1px solid rgba(187,187,187,1);}
        #mainConTitle{width:84%;height:70px;margin:0 2px;margin-top:2px;padding-left:6px;line-height: 16px;vertical-align: middle;}
        #mainContain{width:100%;height:calc(100% - 75px);background:#fff;overflow-y: auto;padding:0;}
        #detailCon .detailContitleBox{width:100%;}
        #detailCon .detailContitleBox td{height:44px;border:1px solid #ccc;text-align: left;padding-left:10px;position: relative;}
        #detailCon .detailContitleBox td input,
        #detailCon .detailContitleBox td select{height:30px;width:76px;padding-left:3px;border:1px solid #bbb;
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            border-radius: 3px;}
        #detailCon .detailContitleBox td .left{float:left;margin:0 2px;position: relative;}
        #talkAboutBox .tittleBox{width:100%;height:40px;line-height: 40px;border:1px solid #bbb;}
        #talkAboutBox .tittleBox span{display:inline-block;height:100%;text-align: center;}
        #talkAboutBox  .commentSectionBox{width:100%;padding:12px;height:260px;overflow-y: auto;}
        #talkAboutBox  .commentSectionBox .commentSection{width:100%;overflow: hidden;height:auto;}
        #talkAboutBox .commentSection .userTitle .imgBox{width:25px;height:25px;border:1px solid #aaa;overflow: hidden;display: inline-block;
            -webkit-border-radius: 50%;
            -moz-border-radius: 50%;
            border-radius: 50%;vertical-align: middle;}
        #talkAboutBox{background:#f0f3f4;}
        #talkAboutBox .userTitle .imgBox img{width:100%;height:100%;}
        #talkAboutBox .commentSection{border-bottom:1px dashed #bbb;}
        #talkAboutBox .commentSection .userTitle{width:150px;float:left;}
        #talkAboutBox .commentSection .conmentsConts{width:calc(100% - 300px);padding:0 15px;float:left;}
        #talkAboutBox .commentSection .conmentsConts>div{padding:9px;}
        #talkAboutBox .commentSection .doBox{float:left;}
        #talkAboutBox .commentSection .doBox .reply{color:#0064b6;padding-right:12px;}
        #talkAboutBox .commentSection .praiseBox i{font-size:18px;margin-right:3px;}
        #talkAboutBox .commontsSrBox{width:100%;min-height:235px;padding:12px;border:1px solid #bbb;position: relative;}
        #myNameSelect{width:145px;height:30px;vertical-align: text-top;}
        #myComments{width:calc(100% - 400px);vertical-align: top;margin-right:9px;height:75px;}
        #mySetNum{width:75px;height:20px;padding-left:6px;}
        #myConmentsEnter{position: absolute;right:62px;top:45px;width:172px;}
        #myConmentsSub{position: absolute;left:95px;top:30px;}
        .selefCon:hover{background:#179d82;color:#fff;}
        .recalltalkcon{padding-left:12px;position: relative}
        .recalltalkcon:hover{background:#179d82;color:#fff;}
        .recalltalkcon .callDoBox{position: absolute;right:-70px;bottom:3px;font-size:11px;}
        .recalltalkcon .callDoBox .reply{padding-right:6px;}
        .recalltalkcon:hover .callDoBox span{color:#bbb;!important;}
        #talkAboutBox .reply:hover,
        #talkAboutBox .praiseBox:hover{color:#f91515;cursor: pointer;}
        #talkAboutBox .commentSection .doBox .reply:hover{color:#f91515;}
        #commentlistBox{width:100%;height:200px;overflow-y: auto;}
        #detailCon .searchMenu .searchTag{width:76px;height:30px;}
        #detailCon .searchMenu .searchSecondMenu{position: absolute;width:100%;left:0;top:28px;background:#eee;color:#bbb;list-style: none;padding:0;z-index: 98;border:1px solid #bbb;border-top:none;display: none;max-height: 420px;overflow-y: auto;}
        #detailCon .searchMenu .searchSecondMenu.show{display: block;}
        #detailCon .searchSecondMenu li{width:100%;text-align: left;padding-left:3px;cursor: pointer;line-height: 23px;}
        #detailCon .searchSecondMenu li:hover{background:#fff;color:#333;border-top:1px solid #bbb;}
        #editoBtn{margin:10px; display: none;}
        #editoBtn.show{display: block;}
        #movieImgBox{position: relative}
        #movieImgBox.show{display: block;}
        #movieImgBox .movieinputBox{position: absolute;left:82px;bottom:1px;width:75px;height:32px;overflow: hidden;}
        #movieImgBox .moviebtn{display: inline-block;width:100%;height:27px;line-height: 27px;text-align: center;background:#568fb9;cursor: pointer;color: #fff;
            -webkit-border-radius: 3px;z-index:50;
            -moz-border-radius: 3px;
            border-radius: 3px;}
        #movieImgBox .movieshowimg{border: 1px solid #9d9e9e;overflow: hidden;width: 80px;height: 80px;line-height: 80px;text-align: center;  background: rgba(255,255,255,.4);  cursor: pointer;}
        #movieImgBox .movieshowimg img{width: auto;height: auto;max-width: 80px;max-height: 80px;}
        #movieimgfile{ position: absolute;top:0;left:0;z-index:60;cursor: pointer;width:100%;height:100%;opacity: 0;}
        #movieImgBox .movieinputBox:hover .moviebtn{background:#204663;}
        #movieImgBox .tips{color:#ce0000;font-size:8px;position: absolute;bottom:25px;left:82px;display: none;}
        #movieImgBox .tips.show{display: block;}
        #recommendPageBox{height:32px;line-height: 32px;}
        #recommendPageBox select{margin-right:5px;}
        #commontsSrBox .imgmovieShowBox{min-height: 130px;width:100%;position: relative;}
        #imgmovieShowConts{width: calc(100% - 400px);margin:5px 9px 0 149px;overflow:hidden;border:1px solid #ddd;padding:4px;}
        #commentInputFile{width:200px;height:30px;position: absolute;top:6px;right: 35px;display: none;}
        .imgmovieShowBox .inputfileBtn{position: absolute;top:6px;right: 60px;}
        #choosePictureBtn{right:154px;}
        .imgMovieShowComBox{width:100%;}
        .imgMovieShowComBox span{display: inline-block;width:85px;height:85px;border:1px solid #ddd;margin:3px;padding:2px; text-align: center;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;}
        .movieshowBox span{width:45%;height:160px;}

        .imgMovieShowComBox span img,
        .imgMovieShowComBox span video{width:auto;height:auto;max-width:100%;max-height: 100%;vertical-align: top;}
        /*多图显示*/
        .delete {
            width: 100px;
            height: 100px;
            position: absolute;
            text-align: center;
            line-height: 100px;
            z-index: 10;
            font-size: 30px;
            background-color: rgba(255,255,255,0.8);
            color: #777;
            opacity: 0;
            transition-duration :0.7s;
            -webkit-transition-duration: 0.7s;
        }
        .delete2{
            font-size:18px; position: absolute;right:8px;top:1px;z-index:12;color:#fff; transition-duration :0.7s; opacity: 0;
            -webkit-transition-duration: 0.7s;cursor: pointer;font-weight:700;
        }
        .delete:hover{
            cursor: pointer;
            opacity: .9;
        }
        .inputFileShow2:hover .delete2{cursor: pointer;opacity: .9;}
        .result {
            width: 100%;
            height: 100%;
            text-align: center;
            box-sizing: border-box;
        }
        .result img, .result video{width:auto;height:auto;max-width:100%;max-height: 100%;}

        .inputFileShow{float: left;width: 110px;height: 110px;overflow: hidden;border: 1px solid #CCCCCC;border-radius: 10px;padding: 5px;margin: 5px;}
        .inputFileShow2{width: 330px;height: 200px;border: 1px solid #CCCCCC;border-radius: 10px;padding: 5px;position: relative;background:#333;}

        .layui-layer-btn{padding:25px 5px !important;}
        .layui-layer-dialog .layui-layer-content{color:#fff;}
        #fixedTips{position: fixed;width:100%;height:100%;background:rgba(0,0,0,.5);z-index: 98;color:#fff;left:0;top:0;display: none;}
        #fixedTips .tips{color:#fff;font-size: 27px;text-align: center;line-height: 350px;}
        /*内容链接*/
        #contentUrlBox{position: fixed;width:100%;height:100%;padding:15px;background:#fff;top:0;bottom:0;left:0;right:0;margin:0 auto;display: none;overflow: auto;}
        #contentUrlBox li{width:100%;line-height: 30px;color:#333;font-size:13px;}

        /*一键生成评论*/
        #creatCommentBtn{position: absolute;right:62px;top:45px;width:172px;}
        /*一键生成评论的框*/
        #creatCommentBox{width:100%;padding:15px;background:#fff;height:100%;display: none;}
        #creatCommentBox .lineBox{width:100%;margin:15px 0;}
        #creatCommentBox .lineTitle{width:120px;display: inline-block;text-align: right;}
        #creatCommentBox select,
        #creatCommentBox input{width:180px;margin-left:6px;}
        #myConmentsEnter {
            top: 80px;
        }
    </style>
</head>

<body class="gray-bg">
<div id="topKzCon">
    <span class="nextBtn btn" onclick="nextcheck()">下一个</span>
    <button type="button" id="subcheckbtn" class="submit btn btn-default" onclick="subd()">提交</button>
 <!--   <a href="#" class="requck btn btnRight">重置</a>-->
    <div class="btnRight" id="recommendPageBox">
        位置：
        <select name="" id="alternativeList">
            <option value="3">请选择</option>
            <option value="1">备选队列</option>
            <option value="2">评论第三条</option>
        </select>
        页数：
        <select name="" id="recommendPageSelect">

            <option value="0">第一页</option>
        </select>
        第几条：
        <select name="" id="recommendItemSelect">
            <option value="">请选择</option>
            <option value="0">第一条</option>
            <option value="1">第二条</option>
            <option value="2">第三条</option>
            <option value="3">第四条</option>
            <option value="4">第五条</option>
            <option value="5">第六条</option>
        </select>

        <span style="margin-left:6px;" class="requck ">待审核数：<b id="unchecknum"></b></span>
    </div>
</div>

<div class="conBox">
    <div id="mainCont" data-id="">
        <div class="mainContitleBox">
            文字描述 <textarea id="mainConTitle" maxlength="300" placeholder="我是标题"></textarea>
            <i class="contitleTip">4个字</i>
        </div>
        <!--视频和图片页面的容器-->
        <div id="mainContain">

        </div>
    </div>
    <div id="detailCon">
        <table class="detailContitleBox">
            <tbody>
            <tr>
                <td id="movietypetd">
                    类型：
                    <span id="movieStyle" data-val="1"></span>
                </td>
                <td>
                    是否通过：
                    <select id="ispassSelect">
                        <option value="YES">通过</option>
                        <option value="NO">不通过</option>

                    </select>
                </td>
            </tr>
            <tr>
                <td id="conlabeltd" colspan="2">
                    <div class="left title">
                        标签分类：
                    </div>
                    <div class="left searchMenu">
                        <input type="search" autocomplete="off" value="" data-val="" placeholder="请选择标签" id="checkTagSearch1" class="searchTag"/>
                        <ul class="searchSecondMenu" id="checkTagul1">

                        </ul>
                    </div>
                    <div class="left searchMenu">
                        <input type="search" autocomplete="off" value="" data-val="" placeholder="请选择标签" id="checkTagSearch2" class="searchTag"/>
                        <ul class="searchSecondMenu" id="checkTagul2">

                        </ul>
                    </div>
                    <div class="left searchMenu">
                        <input type="search" autocomplete="off" value="" data-val="" placeholder="请选择标签" id="checkTagSearch3" class="searchTag"/>
                        <ul class="searchSecondMenu" id="checkTagul3">

                        </ul>
                    </div>
                </td>

            </tr>

            <tr>
                <td>
                    顶： <input type="number" id="goodNum" value="0" min="0"/>
                </td>
                <td class="">
                    踩：<input type="number" id="unsupportNum" value="0" min="0"/>
                </td>
            </tr>
            <tr class="movieTrBox">
             <!--   <td>
                    视频播放时长：<span id="movieTime" data-val=""></span>
                </td>-->
                <td class="moviePlayNumBox" colspan="2">
                    视频播放次数：<input type="number" id="moviePlayNum" value="1" min="0"/>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    发布人：
                    <span id="checkpublisher" data-val="">

                     </span>
                </td>
            </tr>

            <!-- <tr>
                 <td colspan="2" style="height:133px;">
                     专栏选择：<select name="" id="checkColumChoose" style="width:200px;">
                     <option value="1">我是专栏一</option>
                 </select>
                 </td>
             </tr>-->
            <tr>
                <td colspan="">
                    最后审核人：
                    <span id="finalAuditor"></span>
                </td>
                <td>
                    <button type="button" class="btn btn-default" id="lookContentUrl">查看链接</button>
                </td>
            </tr>
            </tbody>
        </table>
        <div id="commentlistBox">
            <ul>
                <li></li>
            </ul>
        </div>
        <!--替换视频封面-->
        <div id="movieCoverChangeBox">
            <button id="editoBtn" class="">图片编辑</button>
            <div id="movieImgBox" class="">
                <div class="movieshowimg">
                    <img src="" alt=""/>
                </div>
                <p class="tips">*视频与缩略图的宽高比有误，请检查！！</p>
                <div class="movieinputBox">
                    <div style="width:100%;position: relative;height:27px;">
                        <input type="file" id="movieimgfile" value="" accept=".png,.jpg,.gif,.jpeg"/>
                        <span class="moviebtn">替换封面</span>
                    </div>

                </div>

            </div>
        </div>
    </div>

</div>

<!--底部评论管理-->
<div id="talkAboutBox">
    <div class="tittleBox">
        <span style="width:43%;">评论管理</span>
        <span style="width:25%;border-right:1px solid #bbb;border-left:1px solid #bbb;">评论数 ：<b class="talkNum"></b></span>
        <span style="width:25%;">热评数 :<b class="hotTalkNum"></b></span>
    </div>
    <div class="commentSectionBox" id="commentSectionBox">
        <div class="commentSection" v-for="(item,i) in items" v-bind:data-commentid="item.commentid" v-bind:data-commentreply="item.commentreply" v-bind:data-replycomment="item.replycomment" v-bind:data-replyuser="item.replyuser" v-bind:data-replyfirst="item.replyfirst">
            <p class="userTitle">
                <span class="imgBox"><img v-bind:src="item.userheadphoto" alt=""/></span>
                <span class="userName" v-bind:class="{trueUser : item.user.usertype==1}" v-bind:data-id="item.userid">{{item.username}}：</span>
            </p>
            <div class="conmentsConts" v-bind:data-replyuser="item.replyuser">
                <div class="selefCon" v-bind:data-contentid="item.contentid">{{item.commenttext}}
                    <!--图片/视频-->
                    <div class="imgMovieShowComBox" v-if="item.commenturltype==3 || item.commenturltype==4">
                        <span v-for="(itemimg,t) in item.commenturl" v-on:click="showimg(item.commenturl,t,1)">
                            <img v-bind:src="itemimg.info" alt="">
                        </span>
                    </div>
                    <div class="imgMovieShowComBox movieshowBox" v-else>
                          <span v-for="(itemimg,t) in item.commenturl" v-on:click="showimg(item.commenturl,t,2)">
                               <video controls="controls" v-bind:src="itemimg.info">您的浏览器不支持</video>
                        </span>
                    </div>
                </div>
                <!--回复-->
                <div class="recalltalkcon" v-for="(itemcon,d) in item.childList"  v-bind:data-contentid="item.contentid"  v-bind:data-commentid="itemcon.commentid" v-bind:data-commentreply="itemcon.commentreply" v-bind:data-replycomment="itemcon.replycomment" v-bind:data-replyuser="itemcon.replyuser" v-bind:data-replyfirst="itemcon.replyfirst">
                    <span class="recalluser" :data-id="itemcon.userid" v-bind:data-replyuser="item.replyuser"><b v-bind:class="{trueUser : itemcon.user.usertype==1}" >{{itemcon.username}}</b>  回复  {{itemcon.ruusername}}：</span>
                    {{itemcon.commenttext}}
                    <!--图片/视频-->
                    <div class="imgMovieShowComBox"  v-if="itemcon.commenturltype==3 ||itemcon.commenturltype==4">
                        <span v-for="(itemimg2,t2) in itemcon.commenturl" v-on:click="showimg(itemcon.commenturl,t2,1)">
                            <img v-bind:src="itemimg2.info" alt="">
                        </span>
                    </div>
                    <div class="imgMovieShowComBox movieshowBox" v-else >
                        <span v-for="(itemimg2,t2) in itemcon.commenturl" v-on:click="showimg(itemcon.commenturl,t2,2)">
                          <video controls="controls" v-bind:src="itemimg2.info">您的浏览器不支持</video>
                        </span>
                    </div>
                    <div class="callDoBox">
                        <span class="reply" v-on:click="backcalltalk(itemcon,i,d)">回复</span>
                        <span v-if="itemcon.addnew==1" class="reply deltecom" v-on:click="comdelete2(itemcon,i,d)">删除</span>
                        <span class="praiseBox"  v-on:click="callgoods(itemcon,i,d)">
                            <i class="glyphicon glyphicon-thumbs-up"></i>
                            <b class="praiseNum">{{itemcon.commentgood}}</b>
                        </span>
                    </div>
                </div>

            </div>
            <div class="doBox">
                <span class="reply" v-on:click="backtalk(item,i)">回复</span>
                <span v-if="item.addnew==1" class="reply deletecom" v-on:click="comdelete(item,i)">删除</span>
                <span class="praiseBox" v-on:click="goods(item,i)">
                    <i class="glyphicon glyphicon-thumbs-up"></i>
                    <b class="praiseNum">{{item.commentgood}}</b>
                </span>
            </div>
        </div>

    </div>

    <div class="commontsSrBox" id="commontsSrBox" data-type="0" data-list="" data-list2="" style="background:#f0f3f4;border-top:1px solid #bbb;padding:3px;padding-bottom:20px;">
        <select name="" id="myNameSelect">
            <!-- <option value="12313"><span class="myname">我是马甲用户</span></option>
             <option value="123134"><span class="myname">我是马甲用户2</span></option>
             <option value="123135"><span class="myname">我是马甲用户3</span></option>-->
        </select>
            <textarea rows="1" cols="20" id="myComments" maxlength="200">

            </textarea>
            <span class="" style="display: inline-block;height:25px;line-height: 25px;">
                点赞数 <input type="number" id="mySetNum" value="0"/>


                <!--<button type="button" class="btn btn-sm btn-primary" id="myConmentsSub" onclick="subd()">提交</button>-->
            </span>
            <div class="imgmovieShowBox">
                <div id="imgmovieShowConts">

                </div>
                <input type="file" id="commentInputFile" name="" accept="image/png,image/gif,image/jpg,image/jpeg"  value="">
                <input type="file" id="commentmovieFile" name="" accept="audio/mp4,video/mp4,application/ogg, audio/ogg"  style="display: none;" value="">
                <button type="button" class="btn btn-default inputfileBtn" id="choosePictureBtn" >选择图片</button>
                <button type="button" class="btn btn-default inputfileBtn" id="chooseMovieBtn">选择视频</button>
                <button type="button" class="btn btn-sm btn-primary" id="creatCommentBtn" onclick="">一键生成评论</button>
                <button type="button" class="btn btn-sm btn-primary" id="myConmentsEnter" onclick="enterd()">发 送</button>
            </div>
    </div>
</div>
<div id="fixedTips">
    <h3 class="tips">已无审核内容！！！</h3>
</div>
<!--评论图片视频点击放大-->
<div id="faxAllBox">
    <div class="toptip"><span><b class="pre">1</b>/ <b class="all">1</b></span><b class="iconfont close" onclick="closeimg()">X</b></div>
    <span class="runLeftBtn runBtn" onclick="turnleftfun()">《</span>
    <span class="runRightBtn runBtn" onclick="turnrightfun()">》</span>
    <ul>

    </ul>
</div>

<!--内容链接-->
    <div id="contentUrlBox">
        <ul>

        </ul>
    </div>

<!--一键生成评论-->
<div id="creatCommentBox">
    <div class="lineBox">
        <span class="lineTitle">选择话题：</span>
        <select name="" id="comentTags"></select>
    </div>
    <div class="lineBox">
        <span class="lineTitle">评论数：</span>
        <input style="width:100px;" id="creatComentNum" type="number" value="1" min="1">
    </div>
    <div style="text-align: center;margin-top:25px;">
        <button type="button" class="btn btn-default" onclick="creatComentSure()">确定</button>
        <button type="button" class="btn btn-default" onclick="closelayerall()">取消</button>
    </div>
</div>

<script src="../../../js/jquery.min.js?v=2.1.4"></script>
<script src="../../../plugin/datepicker/jquery.datetimepicker.full.min.js"></script>
<script src="../../../plugin/layer/layer.js"></script>
<script src="../../../js/vue.js"></script>
<script type="text/javascript" src="../../../js/index.js"></script>
<script src="../../../plugin/cos-js-sdl-v5/cos-js-sdk-v5.min.js"></script>
<script src="../../../plugin/cos-js-sdl-v5/cos.js"></script>
<script src="../../../js/inputmultiple.js"></script>
<script src="../../../js/ugcDefencAddComment.js"></script>
<script type="text/javascript">

    var isreload=1;
    $(function(){
        let dataval="",searchid=0;
        getlabellist(dataval,searchid);//标签
        getpush();//马甲
        getcheckdata();//审核数据
        getrubbigsetpige(3);//推荐队列最大页码
        $("#myComments").empty();
    });



    var contentDatasurllist="";//内容链接（视频，图片地址）

    var fileslist=[];//图片流
    var iffilechange=1;//图片是否有替换或旋转:2视频替换，3图片旋转
    var fielchangelist=[];//图片旋转改变的得到的云链接
    /*品论区*/
    var usertalk = new Vue({
        el: '#commentSectionBox',
        data: {
            items: [],
            postcommentlist:[],
        },
        // 在 `methods` 对象中定义方法
        methods: {
            goods: function (event,i) {
                if(event.user.usertype == 0 && event.addnew && event.addnew ==1){
                    console.log(event);
                    this.items[i].commentgood++;
                }
            },
            callgoods:function (event,i,d) {
                if(event.user.usertype == 0 && event.addnew && event.addnew ==1){
                    console.log(event);
                    this.items[i].childList[d].commentgood++;
                }
            },
            backtalk:function(event,i){
               console.log(event)
                var callid=this.items[i].userid;
                var callname=this.items[i].username;
                $("#commontsSrBox").attr("data-type",1);
                $("#commontsSrBox").attr("data-list",i);
                $("#commontsSrBox").attr("data-list2","");
                $("#myComments").attr("placeholder","回复"+callname+"：")
            },
            backcalltalk:function(event,i,d){
               console.log(event)
                var callid=this.items[i].childList[d].userid;
                var callname=this.items[i].childList[d].username;
                $("#commontsSrBox").attr("data-type",2);
                $("#commontsSrBox").attr("data-list",i);
                $("#commontsSrBox").attr("data-list2",d);
                $("#myComments").attr("placeholder","回复"+callname+"：")
            },
            showimg: function (event,i,type) {
                //  console.log(event);
                // console.log(i);
                /*------自定义的图片左右切换-----------*/
                $("#faxAllBox").addClass("show");
                $("#faxAllBox ul").empty();
                $("#faxAllBox .toptip b.all").html(event.length);
                $("#faxAllBox .toptip b.pre").html(i+1);
                var w=$(window).width();
                var w2=w*event.length+"px";
                $("#faxAllBox ul").css("width",w2);
                var stw='width:'+w+"px";
                $.each(event,function(c,t){
                    if(type==1){
                        if(c==i){
                            $("#faxAllBox ul").append('<li style="'+stw+'" class="show" data-type="'+(c+1)+'"><div class="simgbox"><span class="simgspan"><img src="'+ t.info+'" alt=""/></span></div> </li>');
                        }else{
                            $("#faxAllBox ul").append('<li style="'+stw+'" data-type="'+(c+1)+'"><div class="simgbox"><span class="simgspan"><img src="'+ t.info+'" alt=""/></span></div> </li>');
                        }
                    }else{
                        $("#faxAllBox ul").append('<li style="'+stw+'" class="show" data-type="'+(c+1)+'"><div class="simgbox movieShowBox"><video src="'+ t.info+'" controls="controls"></video></div> </li>');
                    }

                })


            },
            comdelete:function(event,i){//删除评论
                console.log(event);
                layer.confirm('确定删除该评论吗？', {
                    btn: ['确定','取消'] //按钮
                }, function(index){
                    //console.log(recondlist.chooselistnum);
                    let comid= event.commentid;
                    usertalk.items.splice(i,1);
                    // console.log(usertalk.postcommentlist);
                    let lastpostcommentlist=[];
                    $.each(usertalk.postcommentlist,function(c,n){
                        if(n.replyfirst!=comid){
                            lastpostcommentlist.push(usertalk.postcommentlist[c]);
                        }
                    });
                    usertalk.postcommentlist=lastpostcommentlist;
                    if(event.childList && event.childList.length>0){
                        talknum=talknum-event.childList.length;
                    }
                    talknum--;
                    $("#talkAboutBox .talkNum").html(talknum);
                    // console.log("usertalk.postcommentlist：：");
                    // console.log(usertalk.postcommentlist);
                    layer.close(index);
                }, function(index){
                    layer.close(index);
                });


            },
            comdelete2:function(event,i,d){//删除评论
                console.log(event);
                let comid= event.commentid;
                $.each(usertalk.postcommentlist,function(c,n){
                    if(n.commentid==comid){
                        usertalk.postcommentlist.splice(c,1);
                        return false;
                    }
                });
                console.log("usertalk.postcommentlist：：");
                console.log(usertalk.postcommentlist);
                this.items[i].childList.splice(d,1);
                talknum--;
                $("#talkAboutBox .talkNum").html(talknum);

            }
        }
    });


    /*获取审核数据*/
    function getcheckdata(){
        layer.msg('努力中...', {icon: 16,shade: [0.5, '#f5f5f5'],scrollbar: true,offset: '50px', time:1000}) ;
        var datapost={"yes":"one"};
        datapost=JSON.stringify(datapost);
        $.ajax({
            url : path+'/content/getauncheck.do',
            cache:false,//false就不会从浏览器缓存中加载请求信息了
            type:"POST",
            contentType: "application/json",
            dataType:"JSON",
            async:true,
            data: datapost,
            error: function(data){
                layer.msg("服务器未响应,请稍后再试!");
//                //console.log("标签列表获取失败：");
//                //console.log(data);
            },
            success:function(diskJson){
               console.log("ugc审核数据：");
               console.log(diskJson);
                if(diskJson.code=="1000"){
                    getchecktype(diskJson.data);


                }else if(diskJson.code=="2000"){
                    layer.msg(diskJson.message);
                    setTimeout(function(){
                        $("#fixedTips").css({"display":"block"});
                        $("#myConmentsSub").attr("disabled",true);
                        $("#ugcsubbtn").attr("disabled",true);
                        $("#mainConTitle").html("");
                        $("#checkpublisher").html("");
                        $("#mainContain").empty();
                        $('#leftNavsRebox', window.parent.document).removeClass("show");
                       // window.location.href="../index_v1.html"
                    },500)
                }else{
                    layer.msg("数据有误请重试！！")
                }


            }
        })
    }

    /*获取审核类型加载视频/图片页面*/

    function getchecktype(contsdatas){
        //根据iframe的id获取对象
        layer.msg('努力中...', {icon: 16,shade: [0.5, '#f5f5f5'],scrollbar: true,offset: '50px', time:1000}) ;
        //////console.log(ifinfo);
        var murl="moveicheck.html";
        if(contsdatas.contenttype == "3"){
            murl="picturecheck.html";
            $("#movieStyle").attr("data-val",3).html("图片");
            $(".movieTrBox").css({"display":"none"});
            $("#movieCoverChangeBox").css({"display":"none"});
        }else if(contsdatas.contenttype == "4"){
            murl="picturecheck.html";
            $("#movieStyle").attr("data-val",4).html("纯文字");
            $("#movieCoverChangeBox").css({"display":"none"});
            $(".movieTrBox").css({"display":"none"});
        }else{
            murl="moveicheck.html";
            $(".movieTrBox").css({"display":"contents"});
            $("#movieCoverChangeBox").css({"display":"block"});

        }
        //////console.log(ifinfo[1]);
        // ////console.log(murl);
        contentDatasurllist=contsdatas.contenturllist;//内容链接（视频，图片地址）
        $("#mainContain").load(murl,function(){
            geturl(contsdatas.contenturllist);
        });



        contentUrldel(contentDatasurllist);
        /*视频/图片右侧信息*/
        $("#unchecknum").html(contsdatas.pushcount);
        // console.log("contsdatas::");
        // console.log(contsdatas);
        // console.log(contsdatas.contenttitle);
        if(contsdatas.contenttitle && contsdatas.contenttitle !=""){
            let contile=$.trim(contsdatas.contenttitle);
           // let contile2=filteremoji(contile);
            if(contile!="" ){
                $("#mainConTitle").attr("readonly","readonly");
                $("#mainCont .contitleTip").html(contsdatas.contenttitle.length+"/字");
                $("#mainConTitle").val(contile);
            }else{
                $("#mainConTitle").removeAttr("readonly");
                $("#mainCont .contitleTip").html("0/字");
                $("#mainConTitle").val("");
            }

        }else{
            $("#mainConTitle").removeAttr("readonly");
            $("#mainCont .contitleTip").html("0/字");
            $("#mainConTitle").val("");
        }

        // console.log(contsdatas.contentid);
        $("#mainCont").attr("data-id",contsdatas.contentid);
        let createuser=userdatas.data.userid;
        let createuserName=userdatas.data.username;
        $("#finalAuditor").attr("data-id",createuser).html(createuserName);
        $("#checkpublisher").html(contsdatas.contentuid);
        /*标签处理*/
        $("#detailCon .searchMenu .searchTag").val("").attr("data-val","").removeAttr("disabled");
        if(contsdatas.contenttag && contsdatas.contenttag !=""){
            let conlstag=contsdatas.contenttag.split(";");//临时加的
            let tagshow=[];
            $.each(conlstag,function(i,n){
                let sname=$("#checkTagul1 li[data-val="+n +"]").html();
                tagshow.push(sname);
                $("#checkTagSearch"+(i+1)).val(sname ).attr("data-val",n ).attr("disabled","disabled");
            });
        }
        //获取的评论(右侧显示的评论例子)
        getcommentlistdatas(contsdatas.contentid);
        //底部的评论
        if(contsdatas.cmtlist && contsdatas.cmtlist!=""  && contsdatas.cmtlist!=null){
            let commentlists=contsdatas.cmtlist;
            if(commentlists.length >0){
                $.each(commentlists,function(i,n){
                    if(n.commenturl && n.commenturl!=""){
                        if(n.commenturl =="[]"){
                            n.commenturl=[];
                        }else{
                            n.commenturl=JSON.parse(n.commenturl);
                            if(n.commenturl.length >0){
                                n.commenturltype= n.commenturl[0].type;
                            }
                        }
                    }else{
                        n.commenturl=[];
                    }
                    //增加自定义属性firstcommentgood：初始点赞量；addcommentval：增加的的点赞量
                    n.selfaddatr={"firstcommentgood":n.commentgood,"addcommentval":0};
                    if(n.childList.length >0){
                        $.each(n.childList,function(c,t){
                            if(t.commenturl && t.commenturl!=""){
                                if(t.commenturl =="[]"){
                                    t.commenturl=[];
                                }else{
                                    t.commenturl=JSON.parse(t.commenturl);
                                    if(t.commenturl.length >0){
                                        t.commenturltype= t.commenturl[0].type;
                                    }

                                }
                            }else{
                                t.commenturl=[];
                            }
                            t.selfaddatr={"firstcommentgood":t.commentgood,"addcommentval":0};
                        })

                    }

                })

            }
            usertalk.items=commentlists;
        }

    }

    /*NH通过内容id获取评论例子*/
    function getcommentlistdatas(contentid){
        var datapost={"contentid":contentid};
        datapost=JSON.stringify(datapost);
        $.ajax({
            url : path2+'/content/commentList.do',
            cache:true,//false就不会从浏览器缓存中加载请求信息了
            type:"POST",
            contentType: "application/json",
            dataType:"JSON",
            async:false,
            data: datapost,
            //data: {taglevel:3,pageno:1,pagesize:999},
            error: function(data){
                layer.msg("服务器未响应,请稍后再试!");
                ////console.log("标签列表获取失败：");
                ////console.log(data);
            },
            success:function(diskJson){
               // //console.log("NH通过内容id获取评论：");
               // //console.log(diskJson);
                $("#commentlistBox ul").empty();
                if(diskJson.data && diskJson.data.rows.length >0){
                    $.each(diskJson.data.rows,function(i,n){
                        $("#commentlistBox ul").append("<li>"+n.commenttext+"</li>")
                    })
                }
            }
        });
    }
    /*标签列表获取*/
    function getlabellist(dataval,searchid){
        var datapost={"taglevel":2,"pageno":1,"pagesize":999,"tagname":dataval};
        datapost=JSON.stringify(datapost);
        $.ajax({
            url : path2+'/tag/taglist.do',
            cache:true,//false就不会从浏览器缓存中加载请求信息了
            type:"POST",
            contentType: "application/json",
            dataType:"JSON",
            async:false,
            data: datapost,
            //data: {taglevel:3,pageno:1,pagesize:999},
            error: function(data){
                layer.msg("服务器未响应,请稍后再试!");
                ////console.log("标签列表获取失败：");
                ////console.log(data);
            },
            success:function(diskJson){
//                //console.log("标签列表获取：");
//                //console.log(diskJson);

                if(searchid ==0){
                    $(".searchSecondMenu").empty();
                    $("#comentTags").empty();
                    $.each(diskJson.data.rows,function(i,n){
                        $("#comentTags").append('<option value="'+ n.tagid+'">'+ n.tagname+'</option>')
                        if(n.tagid&&n.tagid !=null && n.tagname && n.tagname!=null){
                            $(".searchSecondMenu").append(' <li data-val="'+ n.tagid+'">'+ n.tagname+'</li>');
                        }
                    });
                }else{
                    var searid="#"+searchid;
                    $(searid).siblings(".searchSecondMenu").empty();
                    $.each(diskJson.data.rows,function(i,n){
                        if(n.tagid&&n.tagid !=null && n.tagname && n.tagname!=null){
                            $(searid).siblings(".searchSecondMenu").append(' <li data-val="'+ n.tagid+'">'+ n.tagname+'</li>');
                        }
                    });

                }
            }
        });
    }
    /*标签搜索框焦点事件*/
    $("#detailCon .searchMenu .searchTag").focus(function(){
        $(this).siblings(".searchSecondMenu").addClass("show");
    });
    $("#detailCon .searchMenu .searchTag").blur(function(){
        var searchid=$(this).attr("id");
        setTimeout(function(){
            $("#"+searchid).siblings(".searchSecondMenu").removeClass("show");
        },500);

    });
    /*标签选择*/
    $("#detailCon .searchMenu .searchSecondMenu").delegate("li","click",function(){
        let txt=$(this).html();
        let dataval=$(this).attr("data-val");
        $(this).parent(".searchSecondMenu").siblings(".searchTag").val(txt).attr("data-val",dataval);
    });
    /*搜索框键盘输入*/
    $("#detailCon .searchMenu .searchTag").keyup(function(){
        $(this).attr("data-val","");
        var dataval=$(this).val();
        var searchid=$(this).attr("id");
        getlabellist(dataval,searchid)

    });
    $("#detailCon .searchMenu .searchTag").keydown(function(event) {
        if (event.keyCode == 13) {
            $(this).attr("data-val","");
            var dataval=$(this).val();
            var searchid=$(this).attr("id");
            getlabellist(dataval,searchid);
        }
    });
    /*马甲用户列表获取*/
    function getpush(){
        var createuser=userdatas.data.userid;
        var tjdatas={"followid":"","type":1,"userid":createuser};
        tjdatas=JSON.stringify(tjdatas);
        $.ajax({
            url : path2+'/vest/getAllVestuserList.do',
            cache:true,//false就不会从浏览器缓存中加载请求信息了
            type:"POST",
            contentType: "application/json",
            dataType:"JSON",
            async:false,
            data: tjdatas,
            //data: {taglevel:3,pageno:1,pagesize:999},
            error: function(data){
                layer.msg("服务器未响应,请稍后再试!");
                ////console.log("马甲用户列表失败：");
                ////console.log(data);
            },
            success:function(diskJson){
              //console.log("马甲用户列表获取：");
              //console.log(diskJson);
              //  $("#checkpublisher").empty();
                $("#myNameSelect").empty();
                if(diskJson.data.length >0){
                    $.each(diskJson.data,function(i,n){
                        if(n.isused==1){
                       //     $("#checkpublisher").append(' <option value="'+ n.userid+'">'+ n.username+'</option>');
                            $("#myNameSelect").append(' <option  data-head="'+n.userheadphoto+'" value="'+ n.userid+'">'+ n.username+'</option>');
                        }

                    })
                }



            }
        });
    }

    /*推荐队列最大页码*/
    function getrubbigsetpige(type){
        $("#recommendPageSelect").empty();

        $("#recommendItemSelect").empty();
        if(type == 3 ){
            $("#recommendPageSelect").append(' <option value="">请选择</option>');
            $("#recommendItemSelect").append(' <option value="">请选择</option>');
            for(var i=0;i<100;i++){
                $("#recommendPageSelect").append(' <option value="'+(i+1)+'">第'+(i+1)+'页</option>');
            }
            for(var i=0;i<6;i++){
                $("#recommendItemSelect").append(' <option value="'+(i)+'">第'+(i+1)+'条</option>');
            }
        }else{
            getrubbigsetpige2();
        }

    }

    function getrubbigsetpige2(){
        var tjdatas={"YES":1,};
        tjdatas=JSON.stringify(tjdatas);
        $.ajax({
            url : path2+'/pushbakcontrol/queryAllPageSize.do',
            cache:true,//false就不会从浏览器缓存中加载请求信息了
            type:"POST",
            contentType: "application/json",
            dataType:"JSON",
            async:false,
            data: tjdatas,
            error: function(data){
                layer.msg("服务器未响应,请稍后再试!");
                ////console.log("马甲用户列表失败：");
                ////console.log(data);
            },
            success:function(diskJson){
                //console.log("推荐队列最大页码：");
                //console.log(diskJson);
                $("#recommendPageSelect").empty();
                $("#recommendItemSelect").empty();
                // $("#recommendPageSelect").append(' <option value="">请选择</option>');
                let pagenum=parseInt(diskJson.data);
                for(var i=0;i<=pagenum;i++){
                    $("#recommendPageSelect").append(' <option value="'+(i+1)+'">第'+(i+1)+'页</option>');
                }
                for(var i=0;i<6;i++){
                    $("#recommendItemSelect").append(' <option value="'+(i)+'">第'+(i+1)+'条</option>');
                }
            }
        });
    }

    /*发送*/
    var talknum=0;
    function enterd(){
        var text= $("#myComments").val();
        text= $.trim(text);
        if(text == "" && dataArr==""){
            layer.msg("发送内容不能为空！");
        }else{
            layer.msg("上传中。。。。");
            var commenturl=[];
            var commenturltype="";
            //发送图片
            if(dataArr.length >0){
                //return alert('请先选择文件');
                commenturl=send();
                commenturltype=typefile;
                //send();
            }

            var userid=$("#myNameSelect").val();
            var username=$("#myNameSelect option:checked").text();
            var userHead=$("#myNameSelect option:checked").attr("data-head");
            var lvty= $("#commontsSrBox").attr("data-type");
            var index= $("#commontsSrBox").attr("data-list");
            var index2= $("#commontsSrBox").attr("data-list2");
            var goods=Number($("#mySetNum").val());
            var commentid=genID(22);//评论ID
            var contentid=$("#mainCont").attr("data-id");//内容ID
            var createtime=getmytime();

            if(lvty ==0){
                let comtext={ "addnew":1,"commentid":commentid,"userid":userid,"replyuser":"","ruusername":"","commentreply":1,"userheadphoto":userHead,"username":username,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":"","replyfirst":commentid,"createtime":createtime,childList:[],"commenturl":commenturl,"commenturltype":commenturltype,"user":{"usertype":0},"selfaddatr":{"firstcommentgood":goods,"addcommentval":0}};
                let comtext2={ "addnew":1,"commentid":commentid,"userid":userid,"replyuser":"","ruusername":"","commentreply":1,"userheadphoto":userHead,"username":username,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":"","replyfirst":commentid,"createtime":createtime,"commenturl":commenturl,"commenturltype":commenturltype,"user":{"usertype":0},"selfaddatr":{"firstcommentgood":goods,"addcommentval":0}};
                usertalk.items.push(comtext);
                usertalk.postcommentlist.push(comtext2);
                //usertalk.items.push( { "commentid":commentid,"userid":userid,"replyuser":"","replyusername":"","commentreply":1,"userimg":userHead,"userName":userName,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":"","replyfirst":commentid,"createtime":createtime,recall:[],"commenturl":commenturl,"commenturltype":commenturltype});
            }else if(lvty ==1){
                var replyuser=usertalk.items[index].userid;
                var ruusername=usertalk.items[index].username;
                var replycomment =usertalk.items[index].commentid;
                let comtext={ "addnew":1,"commentid":commentid,"userid":userid,"replyuser":replyuser,"ruusername":ruusername,"commentreply":0,"userheadphoto":userHead,"username":username,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":replycomment,"replyfirst":replycomment,"createtime":createtime,"commenturl":commenturl,"commenturltype":commenturltype,"user":{"usertype":0},"selfaddatr":{"firstcommentgood":goods,"addcommentval":0}}
                let comtext2={ "addnew":1,"commentid":commentid,"userid":userid,"replyuser":replyuser,"ruusername":ruusername,"commentreply":0,"userheadphoto":userHead,"username":username,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":replycomment,"replyfirst":replycomment,"createtime":createtime,"commenturl":commenturl,"commenturltype":commenturltype,"user":{"usertype":0},"selfaddatr":{"firstcommentgood":goods,"addcommentval":0}}
                usertalk.items[index].childList.push(comtext2);
                usertalk.postcommentlist.push(comtext);
                //usertalk.items[index].recall.push({ "commentid":commentid,"userid":userid,"replyuser":replyuser,"replyusername":replyusername,"commentreply":0,"userimg":userHead,"userName":userName,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":replycomment,"replyfirst":replycomment,"createtime":createtime,"commenturl":commenturl,"commenturltype":commenturltype});
            }else if(lvty ==2){
                var replyuser=usertalk.items[index].childList[index2].userid;
                var ruusername=usertalk.items[index].childList[index2].username;
                var replycomment =usertalk.items[index].childList[index2].commentid;
                var replyfirst =usertalk.items[index].commentid;
                let comtext={ "addnew":1,"commentid":commentid,"userid":userid,"replyuser":replyuser,"ruusername":ruusername,"commentreply":0,"userheadphoto":userHead,"username":username,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":replycomment,"replyfirst":replyfirst,"createtime":createtime,"commenturl":commenturl,"commenturltype":commenturltype,"user":{"usertype":0},"selfaddatr":{"firstcommentgood":goods,"addcommentval":0}};
                let comtext2={ "addnew":1,"commentid":commentid,"userid":userid,"replyuser":replyuser,"ruusername":ruusername,"commentreply":0,"userheadphoto":userHead,"username":username,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":replycomment,"replyfirst":replyfirst,"createtime":createtime,"commenturl":commenturl,"commenturltype":commenturltype,"user":{"usertype":0},"selfaddatr":{"firstcommentgood":goods,"addcommentval":0}};
                usertalk.items[index].childList.push(comtext);
                usertalk.postcommentlist.push(comtext2);
                //usertalk.items[index].recall.push({ "commentid":commentid,"userid":userid,"replyuser":replyuser,"replyusername":replyusername,"commentreply":0,"userimg":userHead,"userName":userName,"contentid":contentid,"commenttext":text, "commentgood":goods,"replycomment":replycomment,"replyfirst":replyfirst,"createtime":createtime,"commenturl":commenturl,"commenturltype":commenturltype});
            }
            $("#commontsSrBox").attr("data-type",0);
            $("#myComments").val("");
            $("#mySetNum").val(0);
            talknum++;
            $("#talkAboutBox .talkNum").html(talknum);
            $("#myComments").attr("placeholder","");
            layer.msg("发送成功。。。。");
            // console.log("usertalk.items::");
            // console.log(usertalk.items);
            // console.log("usertalk.postcommentlist：：");
            // console.log(usertalk.postcommentlist);

        }

    }


    /*提交*/
    function subd(){
        layer.confirm('确定提交吗？', {
            btn: ['提交',"取消",'提交并结束审核'] //按钮
            ,btn3:function(index){
                subd2(0);
                layer.close(index);
            }
        }, function(index){
            subd2(1);
            layer.close(index);
        },function(index){
            layer.close(index);
        });
    }

    /*提交图片/视频流*/
    function subd2(isend){
        layer.msg('提交中...', {icon: 16,shade: [0.5, '#f5f5f5'],scrollbar: true,offset: '50px', time:20000}) ;
        let checkuid=userdatas.data.userid;
        let commenttext=usertalk.postcommentlist;//评论
        let contentbad=$("#unsupportNum").val();
        let contentgoods=$("#goodNum").val();
        let contentid= $("#mainCont").attr("data-id");
        let contenttag=[];
        let tag1=$("#checkTagSearch1").attr("data-val");
        let tag2=$("#checkTagSearch2").attr("data-val");
        let tag3=$("#checkTagSearch3").attr("data-val");
        if(tag1 =="" && tag2=="" && tag3 ==""){
            layer.closeAll();
            layer.msg("请至少选择一项标签！！");
            return false;
        }else{
            if(tag1 !="" && tag1 !=null){contenttag.push(tag1)}
            if(tag2 !="" && tag2 !=null){contenttag.push(tag2)}
            if(tag3 !="" && tag3 !=null){contenttag.push(tag3)}
            contenttag=unique10(contenttag)
        }
        let contenttitle=$("#mainConTitle").val();
        if(contenttitle==""){
            layer.msg("请补充内容标题");
            return false;
        }
        let contenttype=$("#movieStyle").attr("data-val");
        let contenturllist=contentDatasurllist;//内容链接
        let indexno=$("#recommendItemSelect").val();//第几条
        let pagenum=$("#recommendPageSelect").val();//去哪一页
        let playcount=0,showtime="",contenttext="";
        if(contenttype ==3 || contenttype ==4){
            playcount=0;
            //showtime="";
           /* if($("#imgconbox a:first-child")){
                let w=$("#imgconbox a:first-child").attr("data-width");
                let h=$("#imgconbox a:first-child").attr("data-height");
                contenttext=w+","+h;
            }*/

        }else{
            playcount=$("#moviePlayNum").val();
            // showtime=$("#movieTime").attr("data-val");
         /*   let w=$("#movieImgBox .movieshowimg img").attr("data-width");
            let h=$("#movieImgBox .movieshowimg img").attr("data-height");
            contenttext=w+","+h;*/
        }
        let ispass=$("#ispassSelect").val();

        let flag=$("#alternativeList").val();
        if(flag ==2){
            if(pagenum ==""||indexno==""){
                layer.msg("请选择页码信息！！");
                return false;
            }
        }
        if(ispass=="NO"){
            flag=3;
        }
        var tjdatas={
            "checkuid":checkuid,
            "commenttext":commenttext,
            "contentbad":contentbad,
            "contentgoods":contentgoods,
            "contentid":contentid,
            "contenttag":contenttag,
            "contenttitle":contenttitle,
            "contenturllist": contenturllist,//
            "indexno": indexno,
            "pagenum": pagenum,
            "playcount": playcount,
            "ispass":ispass,
            "flag":flag
        };
        //console.log("tijiao 2postdata:");
        //console.log(tjdatas);
        tjdatas=JSON.stringify(tjdatas);
        $.ajax({
            url : path+'/content/pushchecked.do',
            cache:true,//false就不会从浏览器缓存中加载请求信息了
            type:"POST",
            contentType: "application/json",
            dataType:"JSON",
            async:false,
            data: tjdatas,
            error: function(data){
                layer.msg("审核提交失败，请重试！！",{
                    offset:['50%'],
                    time: 1500 //2秒关闭（如果不配置，默认是3秒）
                })
                ////console.log("提交图片/视频流失败：");
                ////console.log(data);
            },
            success:function(diskJson){
                layer.closeAll();
                $("#subcheckbtn").attr("disabled","disabled");
                // //console.log("提交审核：");
                //  //console.log(diskJson);
                if(diskJson.code =="1000"){
                    layer.msg("提交成功！！",{
                        icon: 16,
                        offset:['50%'],
                        shade : [0.5 , '#000' , true],
                        time: 1500 //2秒关闭（如果不配置，默认是3秒）
                    });
                    setTimeout(function(){
                        if(isend ==1){
                            layer.msg("下一个！！",{
                                icon: 16,
                                offset:['50%'],
                                shade : [0.5 , '#000' , true],
                                time: 1500 //2秒关闭（如果不配置，默认是3秒）
                            },function(){
                                /*初始化*/
                                backzero();
                                //  window.location.href="../content-manage/ugc-checksconts.html";

                            });
                        }else{
                            layer.msg("返回首页！！",{
                                icon: 16,
                                offset:['50%'],
                                shade : [0.5 , '#000' , true],
                                time: 1500 //2秒关闭（如果不配置，默认是3秒）
                            },function(){
                                isreload=2;
                                $('#leftNavsRebox', window.parent.document).removeClass("show");
                                window.location.href="../../index_v1.html";

                            });
                        }
                    },1500);

                    //
                    // $("#subcheckbtn").attr("disabled","disabled");
                }else{
                    talknum=0;
                    $("#talkAboutBox .talkNum").html(talknum);
                    usertalk.items=[];
                    $("#subcheckbtn").removeAttr("disabled");

                    layer.confirm('提交失败，该条内容可能已被删除(跳过直接审核下个内容，"取消"联系后台人员)', {
                        btn: ['下一条',"取消"] //按钮
                    }, function(index){
                        /*初始化*/
                        backzero();

                        //    window.location.href="../content-manage/ugc-checksconts.html"
                        layer.close(index);

                    },function(index){
                        layer.close(index);
                    });
                }

            }
        });
    }





    /*判断字数*/
    $("#mainConTitle").keyup(function(){
        var len=$(this).val().length;
        $("#mainCont .contitleTip").html(len+"个字");
    });

    function backuncheck(){
        let ifinfo = window.location.search;
        ifinfo=ifinfo.substring(4);
        ifinfo=ifinfo.split(",");
        setTimeout(function(){
//        //console.log(ifinfo);
//        //console.log(ifinfo[2]);
            window.location.href="content-check.html?pageon="+ifinfo[2];
        },250)
    }



    $("#editoBtn").click(function(){
        $("#imgEditBox").addClass("show");
    });


    /*下一个*/
    function nextcheck(){
        layer.confirm('当前内容尚未提交审核，确定跳到下一个吗？', {
            btn: ['确定',"取消"] //按钮
        }, function(index){
            /*初始化*/
            backzero();

            //    window.location.href="../content-manage/ugc-checksconts.html"
            layer.close(index);

        },function(index){
            layer.close(index);
        });

    }


    /*缩略图编辑打开放大*/
    $("#movieImgBox .movieshowimg").click(function(){
        let imgsrc=$("#movieImgBox .movieshowimg img").attr("src");
        $("#imgEditBox .imgshowBox img").attr("src",imgsrc);
        $("#imgEditBox").addClass("show");
    });
    /*视频封面替换*/
    $("#movieimgfile").change(function(){
        var files = this.files[0];
        var fileSize = 0;
        var fileMaxSize = 1024*3;//1M
        var filePath = $("#movieimgfile").val();
        if(filePath){
            fileSize =files.size;
            var size = fileSize / 1024;
            if (size > fileMaxSize) {
                layer.msg("图片太大啦！");
                file.value = "";
                return false;
            }else if (size <= 0) {
                alert("图片呢？？");
                file.value = "";
                return false;
            }
        }
        if (window.FileReader) {
            var reader = new FileReader();
            reader.index = 0;
            reader.file = this.files[0];
            reader.readAsDataURL(this.files[0]);  //转成base64
            reader.fileName = this.files[0].name;
            //监听文件读取结束后事件
            reader.onloadend = function (e) {
                fileslist[0]=files;
                iffilechange=2;
                var imgMsg = {
                    name : this.fileName,//获取文件名
                    file:this.file,//文件流
                    base64 : this.result   //reader.readAsDataURL方法执行完后，base64数据储存在reader.result里
                };
                let img = new Image();              //手动创建一个Image对象
                img.src = e.target.result;//创建Image的对象的url
                img.onload = function () {
                    ////console.log('height:'+this.height+'----width:'+this.width);
                    $("#movieImgBox .movieshowimg img").attr("data-width",this.width);
                    $("#movieImgBox .movieshowimg img").attr("data-height",this.height);
                };
                $("#movieImgBox .movieshowimg img").attr("src",e.target.result);    //e.target.result就是最后的路径地址
                /*提交到腾讯云上*/
                // //console.log("imgMsg::");
                // //console.log(imgMsg);
                runAsync(imgMsg).then(function(data){
                    var onetdk=data.Url.substring(0, data.Url.indexOf('?'));
                    return onetdk;
                }).then(function(onetdk) {
                    // //console.log("onetdk::");
                    // //console.log(onetdk);
                    var moviecover=JSON.parse(contentDatasurllist);
                    moviecover[0]=onetdk;
                    contentDatasurllist=moviecover;

                });

            };
        }
    });


    /*位置选择切换*/
    $("#alternativeList").change(function(){
       var va=$(this).val();
        getrubbigsetpige(va);
    });


    /*初始化*/
    function backzero(){
        $("#detailCon .searchMenu .searchTag").val("");
        $("#checkConLevel").val("0");
        talknum=0;
        $("#talkAboutBox .talkNum").html(talknum);
        usertalk.items=[];
        $("#subcheckbtn").removeAttr("disabled");
        getcheckdata();
        $("#ispassSelect").val("YES");
    }

    //显示内容链接
    function  contentUrldel(contentDatasurllist){
        // console.log("contentDatasurllist::");
        // console.log(contentDatasurllist);
        $("#contentUrlBox ul").empty();
        if(contentDatasurllist && contentDatasurllist!=undefined && contentDatasurllist!=""){
            let nedurl=JSON.parse(contentDatasurllist);
            $.each(nedurl,function(i,n){
                $("#contentUrlBox ul").append('<li><a href="'+n+'" target="_blank">'+n+'</a></li>');
            })
        }



    }
    $("#lookContentUrl").click(function(){
        layer.open({
            type: 1,
            title: '备选队列页码选择',
            maxmin: false, //开启最大化最小化按钮
            area: ['500px', "320px"],
            content: $("#contentUrlBox"),
            success: function (layero, index) {

            }
        });
    });


    /*离开页面时的判断*/
    window.onbeforeunload=function (e){
        if(isreload !=2){
            var e = window.event||e;
            e.returnValue=("确定离开当前页面吗？");
        }

    };


</script>
</body>
</html>